<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customizations and additional features of the patternogram package • patternogram</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Customizations and additional features of the patternogram package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patternogram</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/an-introduction-to-patternogram.html">An introduction to patternogram</a>
    </li>
    <li>
      <a href="../articles/customizations.html">Customizations and additional features of the patternogram package</a>
    </li>
    <li>
      <a href="../articles/spatial-machine-learning.html">An introduction to patternogram</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Nowosad/patternogram/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Customizations and additional features of the
patternogram package</h1>
                        <h4 data-toc-skip class="author">Jakub
Nowosad</h4>
            
            <h4 data-toc-skip class="date">2025-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Nowosad/patternogram/blob/main/vignettes/articles/customizations.Rmd" class="external-link"><code>vignettes/articles/customizations.Rmd</code></a></small>
      <div class="hidden name"><code>customizations.Rmd</code></div>

    </div>

    
    
<p>The <strong>patternogram</strong> package provides tools for visual
exploration of spatial autocorrelation of values from a set of points or
a raster object. This vignette shows various customizations and
additional features available in the package. It extends the
introduction provided in the <a href="an-introduction-to-patternogram.html">An introduction to
patternogram</a> vignette.</p>
<p>Let’s start by attaching the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Nowosad/patternogram" class="external-link">patternogram</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<p>Next, we load two spatial datasets. The first one is a spatial vector
point dataset with annual average air temperature measurements in
Celsius for Spain in 2019. The second one is a raster dataset with
predictors, such as population density (<code>popdens</code>), distance
to the coast (<code>coast</code>), elevation (<code>dem</code>), a
satellite-based Normalized Difference Vegetation Index
(<code>ndvi</code>), and annual average composites of the Land Surface
Temperature product for day (<code>lst_day</code>) and night
(<code>lst_night</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_train</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="st">"/vsicurl/https://github.com/Nowosad/IIIRqueR_workshop_materials/raw/refs/heads/main/data/temp_train.gpkg"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">temp_train</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">predictors</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"/vsicurl/https://github.com/Nowosad/IIIRqueR_workshop_materials/raw/refs/heads/main/data/predictors.tif"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictors</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="section level2">
<h2 id="patternograms-of-point-data">Patternograms of point data<a class="anchor" aria-label="anchor" href="#patternograms-of-point-data"></a>
</h2>
<p>The <code><a href="../reference/patternogram.html">patternogram()</a></code> function is the main function of the
package – it calculates the relationship between spatial distance and
dissimilarity of values and returns an object of the
<code>patternogram</code> class. When the first argument is a set of
points, the function calculates distances between all pairs of points
and dissimilarities between their values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_tt</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">temp_train</span><span class="op">)</span></span>
<span><span class="va">p_tt</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A patternogram: 15 × 3</span></span></span>
<span><span class="co">#&gt;       np   dist dissimilarity</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   334  <span style="text-decoration: underline;">30</span>200          1.72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   910  <span style="text-decoration: underline;">90</span>700          2.10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>289 <span style="text-decoration: underline;">151</span>000          2.27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>622 <span style="text-decoration: underline;">211</span>500          2.49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>883 <span style="text-decoration: underline;">272</span>000          2.60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>081 <span style="text-decoration: underline;">332</span>000          2.83</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>984 <span style="text-decoration: underline;">392</span>500          3.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>914 <span style="text-decoration: underline;">453</span>000          3.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>721 <span style="text-decoration: underline;">513</span>000          3.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">1</span>446 <span style="text-decoration: underline;">573</span>500          3.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">1</span>201 <span style="text-decoration: underline;">634</span>000          4.06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>   986 <span style="text-decoration: underline;">694</span>500          4.38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>   763 <span style="text-decoration: underline;">755</span>000          4.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>   467 <span style="text-decoration: underline;">815</span>000          3.89</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>   215 <span style="text-decoration: underline;">875</span>500          3.52</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_tt</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The result of plotting a patternogram is a scatter plot showing the
dissimilarity of values for different spatial distances. However, often
our point datasets are a sample of a larger population and, moreover,
their values may be subject to measurement errors. Therefore, it is
useful to estimate and visualize <strong>confidence intervals</strong>
of the dissimilarity estimates. To do this, we can set the
<code>interval</code> argument to <code>"confidence"</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_tt_ci</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">temp_train</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">p_tt_ci</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A patternogram: 15 × 5</span></span></span>
<span><span class="co">#&gt;       np   dist dissimilarity ci_lower ci_upper</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   334  <span style="text-decoration: underline;">30</span>200          1.72     1.54     1.93</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   910  <span style="text-decoration: underline;">90</span>700          2.10     1.98     2.21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>289 <span style="text-decoration: underline;">151</span>000          2.27     2.17     2.37</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>622 <span style="text-decoration: underline;">211</span>500          2.49     2.41     2.58</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>883 <span style="text-decoration: underline;">272</span>000          2.60     2.50     2.69</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>081 <span style="text-decoration: underline;">332</span>000          2.83     2.76     2.92</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>984 <span style="text-decoration: underline;">392</span>500          3.25     3.15     3.35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>914 <span style="text-decoration: underline;">453</span>000          3.45     3.36     3.58</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>721 <span style="text-decoration: underline;">513</span>000          3.54     3.43     3.69</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">1</span>446 <span style="text-decoration: underline;">573</span>500          3.85     3.71     3.96</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">1</span>201 <span style="text-decoration: underline;">634</span>000          4.06     3.94     4.17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>   986 <span style="text-decoration: underline;">694</span>500          4.38     4.23     4.52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>   763 <span style="text-decoration: underline;">755</span>000          4.00     3.82     4.17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>   467 <span style="text-decoration: underline;">815</span>000          3.89     3.72     4.08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>   215 <span style="text-decoration: underline;">875</span>500          3.52     3.24     3.81</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_tt_ci</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Now, the resulting patternogram contains two additional columns with
lower and upper confidence intervals of the dissimilarity estimates
(<code>ci_lower</code> and <code>ci_upper</code>). These intervals are
also automatically visualized in the plot.</p>
<p>When the <code>interval</code> argument is set to
<code>"confidence"</code>, the function uses a bootstrap approach to
estimate confidence intervals. By default, it uses 100 bootstrap samples
and a confidence level of 0.95; however, we may customize these settings
using the <code>interval_opts</code> argument. In the next example, we
set the confidence level to 0.99 and the number of bootstrap samples to
250.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_tt_ci2</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">temp_train</span>, interval <span class="op">=</span> <span class="st">"confidence"</span>,</span>
<span>                        interval_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.99</span>, </span>
<span>                                             n_bootstrap <span class="op">=</span> <span class="fl">250</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_tt_ci2</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Now, you may notice that the confidence intervals are wider than in
the previous example, which is expected when we increase the confidence
level.</p>
<!-- where to put/explain cloud? -->
</div>
<div class="section level2">
<h2 id="patternograms-of-raster-data">Patternograms of raster data<a class="anchor" aria-label="anchor" href="#patternograms-of-raster-data"></a>
</h2>
<p>The raster variables have different units and ranges of values, so we
need to standardize them before calculating the patternogram. Otherwise,
the variables with larger ranges will dominate the dissimilarity
calculations. To standardize the variables, we can use min-max
normalization, which rescales the values of each variable to a range
between 0 and 1.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nx</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span>    </span>
<span><span class="va">pr</span> <span class="op">=</span> <span class="op">(</span><span class="va">predictors</span> <span class="op">-</span> <span class="va">nx</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">nx</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">nx</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Similarly to the point data, we can calculate a patternogram for the
raster data using the <code><a href="../reference/patternogram.html">patternogram()</a></code> function. In this
case, the function randomly samples a specified number of points from
the raster (500, by default) and calculates distances and
dissimilarities between all pairs of these sampled points.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_pr</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">pr</span><span class="op">)</span></span>
<span><span class="va">p_pr</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A patternogram: 15 × 3</span></span></span>
<span><span class="co">#&gt;       np   dist dissimilarity</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>804  <span style="text-decoration: underline;">31</span>700         0.204</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">7</span>584  <span style="text-decoration: underline;">95</span>200         0.290</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">10</span>666 <span style="text-decoration: underline;">158</span>500         0.363</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">12</span>846 <span style="text-decoration: underline;">222</span>000         0.408</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">13</span>992 <span style="text-decoration: underline;">285</span>500         0.445</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">14</span>420 <span style="text-decoration: underline;">348</span>500         0.472</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">14</span>077 <span style="text-decoration: underline;">412</span>000         0.493</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">12</span>624 <span style="text-decoration: underline;">475</span>500         0.494</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">10</span>989 <span style="text-decoration: underline;">539</span>000         0.487</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">9</span>069 <span style="text-decoration: underline;">602</span>500         0.492</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">7</span>064 <span style="text-decoration: underline;">665</span>500         0.489</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">4</span>693 <span style="text-decoration: underline;">729</span>000         0.472</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">2</span>359 <span style="text-decoration: underline;">792</span>500         0.490</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>   979 <span style="text-decoration: underline;">856</span>000         0.502</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>   387 <span style="text-decoration: underline;">919</span>500         0.497</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_pr</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Here, we also could estimate <strong>confidence intervals</strong> of
the dissimilarity estimates – we just need to set the
<code>interval</code> argument to <code>"confidence"</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_pr_ci</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">pr</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">p_pr_ci</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A patternogram: 15 × 5</span></span></span>
<span><span class="co">#&gt;       np   dist dissimilarity ci_lower ci_upper</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>937  <span style="text-decoration: underline;">31</span>700         0.196    0.192    0.201</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">7</span>506  <span style="text-decoration: underline;">95</span>200         0.286    0.283    0.289</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">10</span>604 <span style="text-decoration: underline;">158</span>500         0.363    0.361    0.366</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">12</span>836 <span style="text-decoration: underline;">222</span>000         0.413    0.410    0.415</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">14</span>521 <span style="text-decoration: underline;">285</span>500         0.466    0.462    0.469</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">14</span>954 <span style="text-decoration: underline;">348</span>500         0.499    0.496    0.502</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">14</span>711 <span style="text-decoration: underline;">412</span>000         0.515    0.512    0.519</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">12</span>963 <span style="text-decoration: underline;">475</span>500         0.512    0.508    0.515</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">11</span>187 <span style="text-decoration: underline;">539</span>000         0.496    0.492    0.499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">8</span>630 <span style="text-decoration: underline;">602</span>500         0.497    0.495    0.502</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">6</span>118 <span style="text-decoration: underline;">665</span>500         0.507    0.502    0.511</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">4</span>097 <span style="text-decoration: underline;">729</span>000         0.502    0.498    0.508</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">2</span>285 <span style="text-decoration: underline;">792</span>500         0.488    0.481    0.495</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>   993 <span style="text-decoration: underline;">856</span>000         0.469    0.458    0.481</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>   345 <span style="text-decoration: underline;">919</span>500         0.430    0.409    0.453</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_pr_ci</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The above patternogram shows the wider confidence intervals for
larger distances, which is expected because there are fewer point pairs
at larger distances.</p>
<p>Another option for estimating intervals is to use <strong>uncertainty
intervals</strong>, which account for the uncertainty of the sampling
process. Such intervals are estimated using a Monte Carlo approach,
where the sampling of points from the raster is repeated multiple times.
To estimate uncertainty intervals, we need to set the
<code>interval</code> argument to <code>"uncertainty"</code> and to
customize the confidence level and the number of Monte Carlo
repetitions, we may use the <code>interval_opts</code> argument.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_pr_ui</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">pr</span>, interval <span class="op">=</span> <span class="st">"uncertainty"</span>,</span>
<span>                       interval_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.99</span>, </span>
<span>                                            n_montecarlo <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p_pr_ui</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A patternogram: 15 × 5</span></span></span>
<span><span class="co">#&gt;       np   dist dissimilarity ui_lower ui_upper</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>872  <span style="text-decoration: underline;">31</span>700         0.204    0.192    0.222</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">7</span>623  <span style="text-decoration: underline;">95</span>200         0.297    0.286    0.312</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">10</span>998 <span style="text-decoration: underline;">158</span>500         0.369    0.353    0.385</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">13</span>131 <span style="text-decoration: underline;">222</span>000         0.422    0.410    0.435</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">14</span>415 <span style="text-decoration: underline;">285</span>500         0.460    0.444    0.485</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">14</span>741 <span style="text-decoration: underline;">348</span>500         0.492    0.466    0.525</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">14</span>170 <span style="text-decoration: underline;">412</span>000         0.510    0.482    0.542</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">12</span>862 <span style="text-decoration: underline;">475</span>500         0.514    0.484    0.537</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">10</span>917 <span style="text-decoration: underline;">539</span>000         0.510    0.484    0.533</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">8</span>666 <span style="text-decoration: underline;">602</span>500         0.506    0.478    0.528</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">6</span>481 <span style="text-decoration: underline;">665</span>500         0.504    0.476    0.537</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">4</span>226 <span style="text-decoration: underline;">729</span>000         0.494    0.459    0.529</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">2</span>255 <span style="text-decoration: underline;">792</span>500         0.488    0.447    0.525</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>   958 <span style="text-decoration: underline;">856</span>000         0.493    0.435    0.572</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>   343 <span style="text-decoration: underline;">919</span>500         0.458    0.378    0.564</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_pr_ui</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="combining-patternograms">Combining patternograms<a class="anchor" aria-label="anchor" href="#combining-patternograms"></a>
</h2>
<p>We may want to compare patternograms calculated for different
datasets or using different settings. To present such comparisons, let’s
split the <code>temp_train</code> dataset into two subsets: one with
points located in the northern part of Spain and another one with points
located in the southern part of Spain.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_train_north</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">temp_train</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">temp_train</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">4420000</span><span class="op">)</span></span>
<span><span class="va">temp_train_south</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">temp_train</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">temp_train</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">4420000</span><span class="op">)</span></span></code></pre></div>
<p>Next, we calculate patternograms for these two subsets.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_tt_north</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">temp_train_north</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">p_tt_south</span> <span class="op">=</span> <span class="fu"><a href="../reference/patternogram.html">patternogram</a></span><span class="op">(</span><span class="va">temp_train_south</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span></span></code></pre></div>
<p>The resulting patternograms can be combined into a single object
using the <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> function. It accepts multiple patternogram
objects and an optional <code>ids</code> argument, which allows us to
specify labels for each patternogram. The resulting object is also of
the <code>patternogram</code> class and can be plotted using the
<code><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_pr_both</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_tt_north</span>, <span class="va">p_tt_south</span>, ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"north"</span>, <span class="st">"south"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p_pr_both</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A patternogram: 30 × 6</span></span></span>
<span><span class="co">#&gt;       np   dist dissimilarity ci_lower ci_upper id   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   111  <span style="text-decoration: underline;">21</span>300          1.29     1.07     1.49 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   333  <span style="text-decoration: underline;">63</span>900          2.45     2.23     2.68 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   390 <span style="text-decoration: underline;">106</span>600          2.43     2.28     2.57 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   499 <span style="text-decoration: underline;">149</span>000          2.59     2.43     2.73 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   581 <span style="text-decoration: underline;">191</span>500          2.76     2.61     2.94 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   634 <span style="text-decoration: underline;">234</span>500          2.74     2.56     2.89 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   687 <span style="text-decoration: underline;">277</span>000          2.69     2.56     2.83 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   701 <span style="text-decoration: underline;">319</span>500          2.89     2.74     3.05 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   619 <span style="text-decoration: underline;">362</span>500          2.92     2.76     3.10 north</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   514 <span style="text-decoration: underline;">405</span>000          2.91     2.75     3.11 north</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_pr_both</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizations_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>The resulting plot shows that the dissimilarity estimates for the
northern part of Spain are generally higher than those for the southern
part. It means that the temperature values in the northern part of Spain
are more diverse than those in the southern part. This observation may
be related to the fact that the northern part of Spain has a more varied
terrain, including mountains and coastal areas, which can lead to
greater temperature variability.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jakub Nowosad.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
